import{f as $,m as ee,V as N,u as te,_ as se,a as oe,b as m,c as F}from"./VSelect.t8j4SyAx.js";import{L as z,M as J,r as T,z as l,N as L,c as _,O as ie,P as le,Q as B,R as ne,_ as ae,S as de,A as f,m as R,t as re,T as M,U as ue,V as ce,x as I,B as x}from"./entry.xEquNCle.js";import{m as fe,a as me,c as be,u as W,b as Ve,d as ve,e as ge,V as O,f as he,g as we,h as Se,L as ye,i as pe,j as D,k as ke}from"./VSheet.BAdc0PJk.js";function E(e,t){let n=0;for(let s=0;s<t.byteLength;s++)t.setInt8(s,t.getInt8(s)^e.charCodeAt(n)),n++,n>=e.length&&(n=0);return t}function U(e,t){return t=JSON.stringify(t),t=Ce(t),t=E(e,t),t=new TextDecoder("windows-1252").decode(t),t}function Ce(e){const t=new ArrayBuffer(e.length),n=new Int8Array(t);for(let s=0,o=e.length;s<o;s++)n[s]=e.charCodeAt(s);return new DataView(t)}const Pe=z({...fe(),...me()},"VForm"),xe=J()({name:"VForm",props:Pe(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:n,emit:s}=t;const o=be(e),a=T();function b(r){r.preventDefault(),o.reset()}function i(r){const u=r,d=o.validate();u.then=d.then.bind(d),u.catch=d.catch.bind(d),u.finally=d.finally.bind(d),s("submit",u),u.defaultPrevented||d.then(S=>{var v;let{valid:y}=S;y&&((v=a.value)==null||v.submit())}),u.preventDefault()}return W(()=>{var r;return l("form",{ref:a,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:b,onSubmit:i},[(r=n.default)==null?void 0:r.call(n,o)])}),$(o,a)}}),De=z({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ve(),...ee()},"VSwitch"),Ue=J()({name:"VSwitch",inheritAttrs:!1,props:De(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{attrs:n,slots:s}=t;const o=L(e,"indeterminate"),a=L(e,"modelValue"),{loaderClasses:b}=ve(e),{isFocused:i,focus:r,blur:u}=ge(e),d=T(),S=_(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),y=ie(),v=_(()=>e.id||`switch-${y}`);function Q(){o.value&&(o.value=!1)}function X(g){var h,w;g.stopPropagation(),g.preventDefault(),(w=(h=d.value)==null?void 0:h.input)==null||w.click()}return W(()=>{const[g,h]=le(n),w=O.filterProps(e),q=N.filterProps(e);return l(O,B({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":o.value},b.value,e.class]},g,w,{modelValue:a.value,"onUpdate:modelValue":p=>a.value=p,id:v.value,focused:i.value,style:e.style}),{...s,default:p=>{let{id:G,messagesId:H,isDisabled:K,isReadonly:Y,isValid:A}=p;const k={model:a,isValid:A};return l(N,B({ref:d},q,{modelValue:a.value,"onUpdate:modelValue":[V=>a.value=V,Q],id:G.value,"aria-describedby":H.value,type:"checkbox","aria-checked":o.value?"mixed":void 0,disabled:K.value,readonly:Y.value,onFocus:r,onBlur:u},h),{...s,default:V=>{let{backgroundColorClasses:C,backgroundColorStyles:c}=V;return l("div",{class:["v-switch__track",...C.value],style:c.value,onClick:X},[s["track-true"]&&l("div",{key:"prepend",class:"v-switch__track-true"},[s["track-true"](k)]),s["track-false"]&&l("div",{key:"append",class:"v-switch__track-false"},[s["track-false"](k)])])},input:V=>{let{inputNode:C,icon:c,backgroundColorClasses:Z,backgroundColorStyles:j}=V;return l(ne,null,[C,l("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":c||e.loading},e.inset?void 0:Z.value],style:e.inset?void 0:j.value},[s.thumb?l(he,{defaults:{VIcon:{icon:c,size:"x-small"}}},{default:()=>[s.thumb({...k,icon:c})]}):l(we,null,{default:()=>[e.loading?l(ye,{name:"v-switch",active:!0,color:A.value===!1?void 0:S.value},{default:P=>s.loader?s.loader(P):l(pe,{active:P.isActive,color:P.color,indeterminate:!0,size:"16",width:"2"},null)}):c&&l(Se,{key:String(c),icon:c,size:"x-small"},null)]})])])}})}})}),{}}}),Ie={setup(){return{store:te()}},data(){return{wifiList:[],apStatus:-1,show1:!1,show2:!1,secondary:!1,isValid:!0}},computed:{},created(){const{$listen:e}=R();e("bt:connected",()=>{console.log("bt connected"),this.recieveCredentials()}),e("bt:disconnected",()=>{console.log("bt disconnected"),this.$refs.form.reset()})},beforeDestroy(){const{$off:e}=R();e("bt:connected",{}),e("bt:disconnected",{})},methods:{ruleDmx:e=>!e||/^[0-9]{0,3}$/.test(e.toString())&&e>=1&&e<=512||"The field must be a valid decimal 1 to 512",ruleUniverse:e=>!e||/^[0-9]{0,2}$/.test(e.toString())&&e>=0&&e<=15||"The field must be a valid decimal 0 to 15",async recieveCredentials(){let e;const t=new TextDecoder("windows-1252"),n=await this.$espconfig.readCredentials();e=E(this.store.apName,n),e=t.decode(e),console.log(e),this.store.config=JSON.parse(e),await this.recieveWifiList(),this.$espconfig.connectionStatusUuid&&await this.$espconfig.startConnectionstatusNotifications(s=>{this.apStatus=s.target.value.getUint8()})},async recieveWifiList(){if(this.$espconfig.ssidListUuid){const e=new TextDecoder("windows-1252");let t=await this.$espconfig.readSsidlist();if(t)return t=e.decode(t),t=JSON.parse(t),this.wifiList=t.SSID,t;this.dropdownMessage="-- SSID from ESP32 --"}},async submit(e){console.log(this.store.config),this.$espconfig.writeCredentials(U(this.store.apName,this.store.config))},reset(e){this.$espconfig.writeCredentials(U(this.store.apName,{reset:""}))},identify(e){this.$espconfig.writeCredentials(U(this.store.apName,{identify:""}))}}},Ae=I("h2",null,"WiFi configuration",-1),Ne=I("h2",null,"DMX configuration",-1);function Fe(e,t,n,s,o,a){const b=se;return re(),de(b,null,{default:f(()=>[l(ke,null,{default:f(()=>[l(xe,{ref:"form",method:"POST",onSubmit:M(a.submit,["prevent"]),onReset:M(a.reset,["prevent"]),class:"ga-0",modelValue:o.isValid,"onUpdate:modelValue":t[11]||(t[11]=i=>o.isValid=i),disabled:!s.store.btStat},{default:f(()=>[l(oe,{fluid:""},{default:f(()=>[Ae,l(m,{label:"Primary SSID","hide-details":"auto",modelValue:s.store.config.ssidPrim,"onUpdate:modelValue":t[0]||(t[0]=i=>s.store.config.ssidPrim=i)},null,8,["modelValue"]),l(F,{label:"Available SSIDs",density:"compact","hide-details":"auto",items:o.wifiList,modelValue:s.store.config.ssidPrim,"onUpdate:modelValue":t[1]||(t[1]=i=>s.store.config.ssidPrim=i)},null,8,["items","modelValue"]),l(m,{"hide-details":"auto",modelValue:s.store.config.pwPrim,"onUpdate:modelValue":t[2]||(t[2]=i=>s.store.config.pwPrim=i),"append-icon":o.show1?"mdi-eye":"mdi-eye-off",type:o.show1?"text":"password",label:"Primary password","onClick:append":t[3]||(t[3]=i=>o.show1=!o.show1)},null,8,["modelValue","append-icon","type"]),l(Ue,{modelValue:o.secondary,"onUpdate:modelValue":t[4]||(t[4]=i=>o.secondary=i),label:"Use secondary SSID"},null,8,["modelValue"]),ue(I("div",null,[l(m,{label:"Secondary SSID","hide-details":"auto",modelValue:s.store.config.ssidSec,"onUpdate:modelValue":t[5]||(t[5]=i=>s.store.config.ssidSec=i),disabled:!o.secondary},null,8,["modelValue","disabled"]),l(F,{label:"Available SSIDs",density:"compact","hide-details":"auto",items:o.wifiList,modelValue:s.store.config.ssidSec,"onUpdate:modelValue":t[6]||(t[6]=i=>s.store.config.ssidSec=i),disabled:!o.secondary},null,8,["items","modelValue","disabled"]),l(m,{modelValue:s.store.config.pwSec,"onUpdate:modelValue":t[7]||(t[7]=i=>s.store.config.pwSec=i),"append-icon":o.show2?"mdi-eye":"mdi-eye-off",type:o.show2?"text":"password",disabled:!o.secondary,label:"Secondary password","hide-details":"auto","onClick:append":t[8]||(t[8]=i=>o.show2=!o.show2)},null,8,["modelValue","append-icon","type","disabled"])],512),[[ce,o.secondary]]),Ne,l(m,{label:"Start address","hide-details":"auto",rules:[i=>a.ruleDmx(i)],modelValue:s.store.config.stAddr,"onUpdate:modelValue":t[9]||(t[9]=i=>s.store.config.stAddr=i)},null,8,["rules","modelValue"]),l(m,{label:"ArtNet universe","hide-details":"auto",rules:[i=>a.ruleUniverse(i)],modelValue:s.store.config.stUni,"onUpdate:modelValue":t[10]||(t[10]=i=>s.store.config.stUni=i)},null,8,["rules","modelValue"]),l(D,{type:"submit",disabled:!(s.store.btStat&&o.isValid)},{default:f(()=>[x(" Save")]),_:1},8,["disabled"]),l(D,{type:"reset",disabled:!s.store.btStat},{default:f(()=>[x("Reboot")]),_:1},8,["disabled"]),l(D,{onClick:a.identify,disabled:!s.store.btStat},{default:f(()=>[x("Identify")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["onSubmit","onReset","modelValue","disabled"])]),_:1})]),_:1})}const Re=ae(Ie,[["render",Fe]]);export{Re as default};
