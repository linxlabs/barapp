import{d as $,r as I,o as ee,v as te,L as z,M as E,z as i,N as F,c as L,O as oe,P as le,Q as _,R as se,_ as ie,S as ne,A as m,m as B,t as ae,T as R,U as de,V as re,x as A,B as x}from"./entry.TezTpvFD.js";import{f as ue,m as ce,V as T,u as fe,a as me,b,c as M}from"./VSelect.Xqany9OT.js";import{m as be,a as ve,c as ge,u as J,b as Ve,d as he,e as we,V as O,f as Se,g as ye,h as pe,L as ke,i as Ce,j as D,k as Pe}from"./VSheet.l93s6FNA.js";const xe=$({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:t,attrs:n}){const o=I(!1);return ee(()=>{o.value=!0}),l=>{var d;if(o.value)return(d=t.default)==null?void 0:d.call(t);const a=t.fallback||t.placeholder;if(a)return a();const f=l.fallback||l.placeholder||"",s=l.fallbackTag||l.placeholderTag||"span";return te(s,n,f)}}});function W(e,t){let n=0;for(let o=0;o<t.byteLength;o++)t.setInt8(o,t.getInt8(o)^e.charCodeAt(n)),n++,n>=e.length&&(n=0);return t}function U(e,t){return t=JSON.stringify(t),t=De(t),t=W(e,t),t=new TextDecoder("windows-1252").decode(t),t}function De(e){const t=new ArrayBuffer(e.length),n=new Int8Array(t);for(let o=0,l=e.length;o<l;o++)n[o]=e.charCodeAt(o);return new DataView(t)}const Ue=z({...be(),...ve()},"VForm"),Ie=E()({name:"VForm",props:Ue(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:n,emit:o}=t;const l=ge(e),a=I();function f(d){d.preventDefault(),l.reset()}function s(d){const u=d,r=l.validate();u.then=r.then.bind(r),u.catch=r.catch.bind(r),u.finally=r.finally.bind(r),o("submit",u),u.defaultPrevented||r.then(S=>{var g;let{valid:y}=S;y&&((g=a.value)==null||g.submit())}),u.preventDefault()}return J(()=>{var d;return i("form",{ref:a,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:f,onSubmit:s},[(d=n.default)==null?void 0:d.call(n,l)])}),ue(l,a)}}),Ae=z({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ve(),...ce()},"VSwitch"),Ne=E()({name:"VSwitch",inheritAttrs:!1,props:Ae(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{attrs:n,slots:o}=t;const l=F(e,"indeterminate"),a=F(e,"modelValue"),{loaderClasses:f}=he(e),{isFocused:s,focus:d,blur:u}=we(e),r=I(),S=L(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),y=oe(),g=L(()=>e.id||`switch-${y}`);function Q(){l.value&&(l.value=!1)}function X(V){var h,w;V.stopPropagation(),V.preventDefault(),(w=(h=r.value)==null?void 0:h.input)==null||w.click()}return J(()=>{const[V,h]=le(n),w=O.filterProps(e),q=T.filterProps(e);return i(O,_({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":l.value},f.value,e.class]},V,w,{modelValue:a.value,"onUpdate:modelValue":p=>a.value=p,id:g.value,focused:s.value,style:e.style}),{...o,default:p=>{let{id:G,messagesId:H,isDisabled:K,isReadonly:Y,isValid:N}=p;const k={model:a,isValid:N};return i(T,_({ref:r},q,{modelValue:a.value,"onUpdate:modelValue":[v=>a.value=v,Q],id:G.value,"aria-describedby":H.value,type:"checkbox","aria-checked":l.value?"mixed":void 0,disabled:K.value,readonly:Y.value,onFocus:d,onBlur:u},h),{...o,default:v=>{let{backgroundColorClasses:C,backgroundColorStyles:c}=v;return i("div",{class:["v-switch__track",...C.value],style:c.value,onClick:X},[o["track-true"]&&i("div",{key:"prepend",class:"v-switch__track-true"},[o["track-true"](k)]),o["track-false"]&&i("div",{key:"append",class:"v-switch__track-false"},[o["track-false"](k)])])},input:v=>{let{inputNode:C,icon:c,backgroundColorClasses:Z,backgroundColorStyles:j}=v;return i(se,null,[C,i("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":c||e.loading},e.inset?void 0:Z.value],style:e.inset?void 0:j.value},[o.thumb?i(Se,{defaults:{VIcon:{icon:c,size:"x-small"}}},{default:()=>[o.thumb({...k,icon:c})]}):i(ye,null,{default:()=>[e.loading?i(ke,{name:"v-switch",active:!0,color:N.value===!1?void 0:S.value},{default:P=>o.loader?o.loader(P):i(Ce,{active:P.isActive,color:P.color,indeterminate:!0,size:"16",width:"2"},null)}):c&&i(pe,{key:String(c),icon:c,size:"x-small"},null)]})])])}})}})}),{}}}),Fe={setup(){return{store:fe()}},data(){return{wifiList:[],apStatus:-1,show1:!1,show2:!1,secondary:!1,isValid:!0}},computed:{},created(){const{$listen:e}=B();e("bt:connected",()=>{console.log("bt connected"),this.recieveCredentials()}),e("bt:disconnected",()=>{console.log("bt disconnected"),this.$refs.form.reset()})},beforeDestroy(){const{$off:e}=B();e("bt:connected",{}),e("bt:disconnected",{})},methods:{ruleDmx:e=>!e||/^[0-9]{0,3}$/.test(e.toString())&&e>=1&&e<=512||"The field must be a valid decimal 1 to 512",ruleUniverse:e=>!e||/^[0-9]{0,2}$/.test(e.toString())&&e>=0&&e<=15||"The field must be a valid decimal 0 to 15",async recieveCredentials(){let e;const t=new TextDecoder("windows-1252"),n=await this.$espconfig.readCredentials();e=W(this.store.apName,n),e=t.decode(e),console.log(e),this.store.config=JSON.parse(e),await this.recieveWifiList(),this.$espconfig.connectionStatusUuid&&await this.$espconfig.startConnectionstatusNotifications(o=>{this.apStatus=o.target.value.getUint8()})},async recieveWifiList(){if(this.$espconfig.ssidListUuid){const e=new TextDecoder("windows-1252");let t=await this.$espconfig.readSsidlist();if(t)return t=e.decode(t),t=JSON.parse(t),this.wifiList=t.SSID,t;this.dropdownMessage="-- SSID from ESP32 --"}},async submit(e){console.log(this.store.config),this.$espconfig.writeCredentials(U(this.store.apName,this.store.config))},reset(e){this.$espconfig.writeCredentials(U(this.store.apName,{reset:""}))},identify(e){this.$espconfig.writeCredentials(U(this.store.apName,{identify:""}))}}},Le=A("h2",null,"WiFi configuration",-1),_e=A("h2",null,"DMX configuration",-1);function Be(e,t,n,o,l,a){const f=xe;return ae(),ne(f,null,{default:m(()=>[i(Pe,null,{default:m(()=>[i(Ie,{ref:"form",method:"POST",onSubmit:R(a.submit,["prevent"]),onReset:R(a.reset,["prevent"]),class:"ga-0",modelValue:l.isValid,"onUpdate:modelValue":t[11]||(t[11]=s=>l.isValid=s),disabled:!o.store.btStat},{default:m(()=>[i(me,{fluid:""},{default:m(()=>[Le,i(b,{label:"Primary SSID","hide-details":"auto",modelValue:o.store.config.ssidPrim,"onUpdate:modelValue":t[0]||(t[0]=s=>o.store.config.ssidPrim=s)},null,8,["modelValue"]),i(M,{label:"Available SSIDs",density:"compact","hide-details":"auto",items:l.wifiList,modelValue:o.store.config.ssidPrim,"onUpdate:modelValue":t[1]||(t[1]=s=>o.store.config.ssidPrim=s)},null,8,["items","modelValue"]),i(b,{"hide-details":"auto",modelValue:o.store.config.pwPrim,"onUpdate:modelValue":t[2]||(t[2]=s=>o.store.config.pwPrim=s),"append-icon":l.show1?"mdi-eye":"mdi-eye-off",type:l.show1?"text":"password",label:"Primary password","onClick:append":t[3]||(t[3]=s=>l.show1=!l.show1)},null,8,["modelValue","append-icon","type"]),i(Ne,{modelValue:l.secondary,"onUpdate:modelValue":t[4]||(t[4]=s=>l.secondary=s),label:"Use secondary SSID"},null,8,["modelValue"]),de(A("div",null,[i(b,{label:"Secondary SSID","hide-details":"auto",modelValue:o.store.config.ssidSec,"onUpdate:modelValue":t[5]||(t[5]=s=>o.store.config.ssidSec=s),disabled:!l.secondary},null,8,["modelValue","disabled"]),i(M,{label:"Available SSIDs",density:"compact","hide-details":"auto",items:l.wifiList,modelValue:o.store.config.ssidSec,"onUpdate:modelValue":t[6]||(t[6]=s=>o.store.config.ssidSec=s),disabled:!l.secondary},null,8,["items","modelValue","disabled"]),i(b,{modelValue:o.store.config.pwSec,"onUpdate:modelValue":t[7]||(t[7]=s=>o.store.config.pwSec=s),"append-icon":l.show2?"mdi-eye":"mdi-eye-off",type:l.show2?"text":"password",disabled:!l.secondary,label:"Secondary password","hide-details":"auto","onClick:append":t[8]||(t[8]=s=>l.show2=!l.show2)},null,8,["modelValue","append-icon","type","disabled"])],512),[[re,l.secondary]]),_e,i(b,{label:"Start address","hide-details":"auto",rules:[s=>a.ruleDmx(s)],modelValue:o.store.config.stAddr,"onUpdate:modelValue":t[9]||(t[9]=s=>o.store.config.stAddr=s)},null,8,["rules","modelValue"]),i(b,{label:"ArtNet universe","hide-details":"auto",rules:[s=>a.ruleUniverse(s)],modelValue:o.store.config.stUni,"onUpdate:modelValue":t[10]||(t[10]=s=>o.store.config.stUni=s)},null,8,["rules","modelValue"]),i(D,{type:"submit",disabled:!(o.store.btStat&&l.isValid)},{default:m(()=>[x(" Save")]),_:1},8,["disabled"]),i(D,{type:"reset",disabled:!o.store.btStat},{default:m(()=>[x("Reboot")]),_:1},8,["disabled"]),i(D,{onClick:a.identify,disabled:!o.store.btStat},{default:m(()=>[x("Identify")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["onSubmit","onReset","modelValue","disabled"])]),_:1})]),_:1})}const Oe=ie(Fe,[["render",Be]]);export{Oe as default};
