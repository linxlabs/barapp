import{f as Z,m as $,V as A,_ as ee,a as te,b as f,c as F}from"./VSelect.WrvqnjTN.js";import{L as j,M as O,r as z,z as i,N as _,c as L,O as se,P as oe,Q as R,R as le,_ as ie,S as ae,A as m,m as B,t as ne,T,U as de,V as re,x as I,B as U}from"./entry.gGa_yKcG.js";import{j as ue,a as x}from"./string_helpers.JND0Veto.js";import{m as ce,a as me,c as fe,u as W,b as ve,d as Ve,e as be,V as M,f as ge,g as Se,h as he,L as pe,i as we,j as ye,k as D,l as ke}from"./VSheet.r2ZznRNu.js";const Ce=j({...ce(),...me()},"VForm"),Pe=O()({name:"VForm",props:Ce(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:d,emit:s}=t;const o=fe(e),a=z();function v(r){r.preventDefault(),o.reset()}function l(r){const u=r,n=o.validate();u.then=n.then.bind(n),u.catch=n.catch.bind(n),u.finally=n.finally.bind(n),s("submit",u),u.defaultPrevented||n.then(p=>{var b;let{valid:w}=p;w&&((b=a.value)==null||b.submit())}),u.preventDefault()}return W(()=>{var r;return i("form",{ref:a,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:v,onSubmit:l},[(r=d.default)==null?void 0:r.call(d,o)])}),Z(o,a)}}),Ue=j({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...ve(),...$()},"VSwitch"),xe=O()({name:"VSwitch",inheritAttrs:!1,props:Ue(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{attrs:d,slots:s}=t;const o=_(e,"indeterminate"),a=_(e,"modelValue"),{loaderClasses:v}=Ve(e),{isFocused:l,focus:r,blur:u}=be(e),n=z(),p=L(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),w=se(),b=L(()=>e.id||`switch-${w}`);function E(){o.value&&(o.value=!1)}function J(g){var S,h;g.stopPropagation(),g.preventDefault(),(h=(S=n.value)==null?void 0:S.input)==null||h.click()}return W(()=>{const[g,S]=oe(d),h=M.filterProps(e),Q=A.filterProps(e);return i(M,R({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":o.value},v.value,e.class]},g,h,{modelValue:a.value,"onUpdate:modelValue":y=>a.value=y,id:b.value,focused:l.value,style:e.style}),{...s,default:y=>{let{id:X,messagesId:q,isDisabled:G,isReadonly:H,isValid:N}=y;const k={model:a,isValid:N};return i(A,R({ref:n},Q,{modelValue:a.value,"onUpdate:modelValue":[V=>a.value=V,E],id:X.value,"aria-describedby":q.value,type:"checkbox","aria-checked":o.value?"mixed":void 0,disabled:G.value,readonly:H.value,onFocus:r,onBlur:u},S),{...s,default:V=>{let{backgroundColorClasses:C,backgroundColorStyles:c}=V;return i("div",{class:["v-switch__track",...C.value],style:c.value,onClick:J},[s["track-true"]&&i("div",{key:"prepend",class:"v-switch__track-true"},[s["track-true"](k)]),s["track-false"]&&i("div",{key:"append",class:"v-switch__track-false"},[s["track-false"](k)])])},input:V=>{let{inputNode:C,icon:c,backgroundColorClasses:K,backgroundColorStyles:Y}=V;return i(le,null,[C,i("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":c||e.loading},e.inset?void 0:K.value],style:e.inset?void 0:Y.value},[s.thumb?i(ge,{defaults:{VIcon:{icon:c,size:"x-small"}}},{default:()=>[s.thumb({...k,icon:c})]}):i(Se,null,{default:()=>[e.loading?i(pe,{name:"v-switch",active:!0,color:N.value===!1?void 0:p.value},{default:P=>s.loader?s.loader(P):i(we,{active:P.isActive,color:P.color,indeterminate:!0,size:"16",width:"2"},null)}):c&&i(he,{key:String(c),icon:c,size:"x-small"},null)]})])])}})}})}),{}}}),De={setup(){return{store:ye()}},data(){return{wifiList:[],apStatus:-1,show1:!1,show2:!1,secondary:!1,isValid:!0}},computed:{},created(){const{$listen:e}=B();e("bt:connected",()=>{console.log("bt connected"),this.recieveCredentials()}),e("bt:disconnected",()=>{console.log("bt disconnected"),this.$refs.form.reset()})},beforeDestroy(){const{$off:e}=B();e("bt:connected",{}),e("bt:disconnected",{})},methods:{ruleDmx:e=>!e||/^[0-9]{0,3}$/.test(e.toString())&&e>=1&&e<=512||"The field must be a valid decimal 1 to 512",ruleUniverse:e=>!e||/^[0-9]{0,2}$/.test(e.toString())&&e>=0&&e<=15||"The field must be a valid decimal 0 to 15",async recieveCredentials(){let e;const t=new TextDecoder("windows-1252"),d=await this.$espconfig.readCredentials();e=ue(this.store.apName,d),e=t.decode(e),console.log(e),this.store.config=JSON.parse(e),await this.recieveWifiList(),this.$espconfig.connectionStatusUuid&&await this.$espconfig.startConnectionstatusNotifications(s=>{this.apStatus=s.target.value.getUint8()})},async recieveWifiList(){if(this.$espconfig.ssidListUuid){const e=new TextDecoder("windows-1252");let t=await this.$espconfig.readSsidlist();if(t)return t=e.decode(t),t=JSON.parse(t),this.wifiList=t.SSID,t;this.dropdownMessage="-- SSID from ESP32 --"}},async submit(e){console.log(this.store.config),this.$espconfig.writeCredentials(x(this.store.apName,this.store.config))},reset(e){this.$espconfig.writeCredentials(x(this.store.apName,{reset:""}))},identify(e){this.$espconfig.writeCredentials(x(this.store.apName,{identify:""}))}}},Ie=I("h2",null,"WiFi configuration",-1),Ne=I("h2",null,"DMX configuration",-1);function Ae(e,t,d,s,o,a){const v=ee;return ne(),ae(v,null,{default:m(()=>[i(ke,null,{default:m(()=>[i(Pe,{ref:"form",method:"POST",onSubmit:T(a.submit,["prevent"]),onReset:T(a.reset,["prevent"]),class:"ga-0",modelValue:o.isValid,"onUpdate:modelValue":t[11]||(t[11]=l=>o.isValid=l),disabled:!s.store.btStat},{default:m(()=>[i(te,{fluid:""},{default:m(()=>[Ie,i(f,{label:"Primary SSID","hide-details":"auto",modelValue:s.store.config.ssidPrim,"onUpdate:modelValue":t[0]||(t[0]=l=>s.store.config.ssidPrim=l)},null,8,["modelValue"]),i(F,{label:"Available SSIDs",density:"compact","hide-details":"auto",items:o.wifiList,modelValue:s.store.config.ssidPrim,"onUpdate:modelValue":t[1]||(t[1]=l=>s.store.config.ssidPrim=l)},null,8,["items","modelValue"]),i(f,{"hide-details":"auto",modelValue:s.store.config.pwPrim,"onUpdate:modelValue":t[2]||(t[2]=l=>s.store.config.pwPrim=l),"append-icon":o.show1?"mdi-eye":"mdi-eye-off",type:o.show1?"text":"password",label:"Primary password","onClick:append":t[3]||(t[3]=l=>o.show1=!o.show1)},null,8,["modelValue","append-icon","type"]),i(xe,{modelValue:o.secondary,"onUpdate:modelValue":t[4]||(t[4]=l=>o.secondary=l),label:"Use secondary SSID"},null,8,["modelValue"]),de(I("div",null,[i(f,{label:"Secondary SSID","hide-details":"auto",modelValue:s.store.config.ssidSec,"onUpdate:modelValue":t[5]||(t[5]=l=>s.store.config.ssidSec=l),disabled:!o.secondary},null,8,["modelValue","disabled"]),i(F,{label:"Available SSIDs",density:"compact","hide-details":"auto",items:o.wifiList,modelValue:s.store.config.ssidSec,"onUpdate:modelValue":t[6]||(t[6]=l=>s.store.config.ssidSec=l),disabled:!o.secondary},null,8,["items","modelValue","disabled"]),i(f,{modelValue:s.store.config.pwSec,"onUpdate:modelValue":t[7]||(t[7]=l=>s.store.config.pwSec=l),"append-icon":o.show2?"mdi-eye":"mdi-eye-off",type:o.show2?"text":"password",disabled:!o.secondary,label:"Secondary password","hide-details":"auto","onClick:append":t[8]||(t[8]=l=>o.show2=!o.show2)},null,8,["modelValue","append-icon","type","disabled"])],512),[[re,o.secondary]]),Ne,i(f,{label:"Start address","hide-details":"auto",rules:[l=>a.ruleDmx(l)],modelValue:s.store.config.stAddr,"onUpdate:modelValue":t[9]||(t[9]=l=>s.store.config.stAddr=l)},null,8,["rules","modelValue"]),i(f,{label:"ArtNet universe","hide-details":"auto",rules:[l=>a.ruleUniverse(l)],modelValue:s.store.config.stUni,"onUpdate:modelValue":t[10]||(t[10]=l=>s.store.config.stUni=l)},null,8,["rules","modelValue"]),i(D,{type:"submit",disabled:!(s.store.btStat&&o.isValid)},{default:m(()=>[U(" Save")]),_:1},8,["disabled"]),i(D,{type:"reset",disabled:!s.store.btStat},{default:m(()=>[U("Reboot")]),_:1},8,["disabled"]),i(D,{onClick:a.identify,disabled:!s.store.btStat},{default:m(()=>[U("Identify")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["onSubmit","onReset","modelValue","disabled"])]),_:1})]),_:1})}const Be=ie(De,[["render",Ae]]);export{Be as default};
